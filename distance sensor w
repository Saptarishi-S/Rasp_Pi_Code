import RPi.GPIO as GPIO
import time

# Define GPIO pins for Sensor 1
TRIG_PIN1 = 2
ECHO_PIN1 = 15

# Define GPIO pins for Sensor 2
TRIG_PIN2 = 18
ECHO_PIN2 = 5

# Define GPIO pins for Sensor 3
TRIG_PIN3 = 27
ECHO_PIN3 = 26

# LED pins
LEDPIN1 = 13
LEDPIN2 = 12
LEDPIN3 = 14

GPIO.setmode(GPIO.BCM)

# Setup GPIO pins
def setup():
    GPIO.setup(LEDPIN1, GPIO.OUT)
    GPIO.setup(TRIG_PIN1, GPIO.OUT)
    GPIO.setup(ECHO_PIN1, GPIO.IN)

    GPIO.setup(LEDPIN2, GPIO.OUT)
    GPIO.setup(TRIG_PIN2, GPIO.OUT)
    GPIO.setup(ECHO_PIN2, GPIO.IN)

    GPIO.setup(LEDPIN3, GPIO.OUT)
    GPIO.setup(TRIG_PIN3, GPIO.OUT)
    GPIO.setup(ECHO_PIN3, GPIO.IN)

def read_distance(trig_pin, echo_pin):
    GPIO.output(trig_pin, False)
    time.sleep(0.2)

    GPIO.output(trig_pin, True)
    time.sleep(0.00001)
    GPIO.output(trig_pin, False)

    while GPIO.input(echo_pin) == 0:
        pulse_start = time.time()

    while GPIO.input(echo_pin) == 1:
        pulse_end = time.time()

    pulse_duration = pulse_end - pulse_start
    distance = pulse_duration * 17150  # Speed of sound is 343 m/s or 17150 cm/s
    return distance

def loop():
    while True:
        distance1 = read_distance(TRIG_PIN1, ECHO_PIN1)
        distance2 = read_distance(TRIG_PIN2, ECHO_PIN2)
        distance3 = read_distance(TRIG_PIN3, ECHO_PIN3)

        is_nearby1 = distance1 > 200
        GPIO.output(LEDPIN1, is_nearby1)

        is_nearby2 = distance2 > 200
        GPIO.output(LEDPIN2, is_nearby2)

        is_nearby3 = distance3 > 200
        GPIO.output(LEDPIN3, is_nearby3)

        print("Measured distance:", distance1, "cm", distance2, "cm", distance3, "cm")
        time.sleep(0.1)

if __name__ == "__main__":
    setup()
    loop()
